var laPrms=function(){function a(){var a,c,h=[],i=g(),j=g(),k=function(){if(i.flag)throw"The promise is already resolved";if(j.flag)throw"The promise is already rejected"},l=function(e,g){return c?c=d(c,e,g):(f(e,g,h),i.flag?n():j.flag&&o()),c?b(c)?c:null:a},m=function(a){return l(null,a)},n=function(){try{c=e("resolve",i.msg,h)}catch(a){i.flag=!1,q(a)}},o=function(){c=e("reject",j.msg,h)},p=function(a){k(),i.flag=!0,i.msg=a,n()},q=function(a){k(),j.flag=!0,j.msg=a,o()};return a={then:l,"catch":m},{promise:a,resolve:p,reject:q}}var b=function(a){return a&&a.then},c=function(){return{}},d=function(a,d,e){if(!b(a))throw"This object is not valid promise";var f=a.then(d,e);return b(f)||(f=c()),f},e=function(a,e,f){var g=0,h=null;for(i=0;i<f.length;i++)if(f[i][a]){g=i,h=f[i][a];break}if(!h)return null;var j=h(e);if(!b(j))return c();for(i=g+1;i<f.length;i++)if(j=d(j,f[i].resolve,f[i].reject),!b(j))return j;return j},f=function(a,b,c){var d={resolve:a,reject:b};c.push(d)},g=function(){return{flag:!1,msg:null}},h=function(){return new a},j=function(a){var b=h();return a(b.resolve,b.reject),b.promise};return{defer:h,createPromise:j}}();