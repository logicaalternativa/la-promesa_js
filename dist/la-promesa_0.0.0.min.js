function defered(){var a,b=[],c=function(){var c=function(b){a=b},d=function(a,e){var f={resolve:a,reject:e};return b.push(f),{then:d,"catch":c}};return{then:d,"catch":c}},d=function(c,d){if(c&&c.then&&c["catch"]){for(var e=1;e<b.length;e++)c.then(d[e].resolve,d[e].reject);a&&c["catch"](a)}},e=function(a){var c=function(){var c=b[0].resolve,e=c(a);d(e,b)};b[0]&&b[0].resolve?c():setTimeout(c,0)};return{resolve:e,getPromise:c}}